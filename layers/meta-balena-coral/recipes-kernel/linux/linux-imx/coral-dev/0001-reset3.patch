From 8ef20c504fce153daad17520b6446bed39aa5805 Mon Sep 17 00:00:00 2001
From: Alexandru Costache <alexandru@balena.io>
Date: Wed, 8 Jul 2020 15:02:02 +0200
Subject: [PATCH] reset3

---
 .../dts/freescale/fsl-imx8mq-phanbell.dts     | 23 +++++++++++++++++--
 arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi |  2 ++
 2 files changed, 23 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-imx8mq-phanbell.dts b/arch/arm64/boot/dts/freescale/fsl-imx8mq-phanbell.dts
index 8896a166d56b..db86ed0d3d68 100644
--- a/arch/arm64/boot/dts/freescale/fsl-imx8mq-phanbell.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-imx8mq-phanbell.dts
@@ -70,6 +70,19 @@
 		google,model = "edgetpu-audio-card";
 		status = "okay";
 	};
+
+        gpio-keys {
+                compatible = "gpio-keys";
+                pinctrl-names = "default";
+                pinctrl-0 = <&pinctrl_keys>;
+                wakeup{
+                        label = "wakeup gpio";
+                        gpios = <&gpio3 13 GPIO_ACTIVE_LOW>;
+                        linux,code = <KEY_WAKEUP>;
+			wakeup-source;
+                };
+        };
+
 };
 
 &iomuxc {
@@ -166,7 +179,6 @@
 				MX8MQ_IOMUXC_GPIO1_IO07_GPIO1_IO7		0x19
 				MX8MQ_IOMUXC_GPIO1_IO08_GPIO1_IO8		0x19
 				MX8MQ_IOMUXC_NAND_DATA03_GPIO3_IO9		0x19
-				MX8MQ_IOMUXC_NAND_DATA07_GPIO3_IO13		0x19
 				MX8MQ_IOMUXC_NAND_READY_B_GPIO3_IO16		0x19
 				MX8MQ_IOMUXC_NAND_WE_B_GPIO3_IO17		0x19
 				MX8MQ_IOMUXC_ECSPI2_SCLK_GPIO5_IO10		0x19
@@ -212,6 +224,13 @@
 				/* vsync pin mux? can't find in schematic */
 			>;
 		};
+
+
+		pinctrl_keys: keys1grp {
+			fsl,pins = <
+	                MX8MQ_IOMUXC_NAND_DATA07_GPIO3_IO13             0x19
+		>;
+		};
 	};
 };
 
@@ -332,7 +351,7 @@
 	port {
 		csi1_ep: endpoint {
 			remote-endpoint = <&csi1_mipi_ep>;
-		};
+		}; 
 	};
 };
 
diff --git a/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi b/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi
index b560bec57402..b324ce20ed99 100755
--- a/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi
@@ -338,6 +338,8 @@
 		#gpio-cells = <2>;
 		interrupt-controller;
 		#interrupt-cells = <2>;
+                pad-wakeup-num = <1>;
+                pad-wakeup = <160 4 13>;
 	};
 
 	gpio4: gpio@30230000 {
-- 
2.17.1

